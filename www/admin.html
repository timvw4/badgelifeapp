<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BadgeLife ‚Ä¢ Admin badges</title>
  <link rel="stylesheet" href="./styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script type="module" src="./admin.js" defer></script>
</head>
<body class="admin-page">
  <div class="page">
    <header class="topbar">
      <div class="brand">
        <div>
          <strong>Gestion des badges</strong>
        </div>
      </div>
    </header>

    <!-- Section connexion admin -->
    <section class="card" id="admin-auth-card">
      <h2>Connexion admin</h2>
      <p class="muted">Entre ton pseudo et ton mot de passe admin.</p>
      <form id="admin-login-form" class="auth-form">
        <label for="admin-username">Pseudo</label>
        <input id="admin-username" type="text" required placeholder="Ex: AdminMaster">
        <label for="admin-password">Mot de passe</label>
        <input id="admin-password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        <button type="submit" class="primary">Se connecter</button>
      </form>
      <p id="admin-message" class="message"></p>
    </section>

    <!-- Application admin -->
    <section id="admin-app" class="card hidden">
      <div class="admin-header">
        <h2>Badges</h2>
        <div style="display: flex; gap: 8px;">
          <a href="./index.html" class="ghost">Revenir au profil</a>
        <button id="admin-logout" class="ghost">Se d√©connecter</button>
        </div>
      </div>
      
      <!-- Section gestion des jetons -->
      <div class="admin-section">
        <h3>ü™ô Gestion des jetons</h3>
        <p class="muted">Ajoute des jetons √† ton compte admin.</p>
        <form id="tokens-form" class="auth-form" style="max-width: 400px;">
          <label for="tokens-amount">Nombre de jetons √† ajouter</label>
          <input id="tokens-amount" type="number" min="1" step="1" value="10" required placeholder="Ex: 10">
          <button type="submit" class="primary">Ajouter les jetons</button>
        </form>
        <p id="tokens-message" class="message"></p>
      </div>

      <!-- Grille liste + √©dition -->
      <div class="admin-grid">
        <!-- Colonne liste -->
        <div>
          <div class="admin-header">
            <h3>üìã Liste</h3>
            <div class="admin-stats">
              <small id="admin-badge-total" class="muted">Total : 0</small>
              <small id="admin-skills-total" class="muted">Skills : 0</small>
              <small id="admin-low-skills-total" class="muted">Low skills : 0</small>
            </div>
          </div>
          <div class="admin-table">
            <div class="table-head">
              <span>Emoji</span>
              <span>Nom</span>
              <span>Statut skills</span>
            </div>
            <div id="badge-list" class="table-body"></div>
          </div>
        </div>

        <!-- Colonne √©dition -->
        <div>
          <h3>‚úèÔ∏è √âdition / cr√©ation</h3>
          <form id="badge-form" class="auth-form">
            
            <!-- Informations de base -->
            <div class="form-group">
              <label for="badge-id" class="form-label">ID (optionnel si auto-incr.)</label>
              <input id="badge-id" type="text" placeholder="Laisse vide pour nouvel ID">

              <label for="badge-name" class="form-label form-label-spaced">Nom</label>
              <input id="badge-name" type="text" required>

              <label for="badge-expert-name" class="form-label form-label-spaced">Nom expert (optionnel)</label>
              <input id="badge-expert-name" type="text" placeholder="Nom affich√© quand le badge est au niveau expert">
              <small class="muted">Si d√©fini, ce nom remplacera le nom du badge quand il atteint le niveau expert. L'emoji reste inchang√©.</small>

              <label for="badge-emoji" class="form-label form-label-spaced">Emoji</label>
              <input id="badge-emoji" type="text" placeholder="Ex: üöÄ">

              <label for="badge-question" class="form-label form-label-spaced non-ghost-only">Question</label>
              <textarea id="badge-question" class="non-ghost-only" rows="2"></textarea>
            </div>

            <!-- Th√®me -->
            <div class="form-group">
              <label for="badge-theme" class="form-label">Th√®me</label>
              <select id="badge-theme">
                <option value="">Choisis un th√®me...</option>
                <option value="Sport">Sport</option>
                <option value="Voyage">Voyage</option>
                <option value="Pays">Pays</option>
                <option value="Relations">Relations</option>
                <option value="Amour">Amour</option>
                <option value="√âtudes">√âtudes</option>
                <option value="Travail">Travail</option>
                <option value="Loisir">Loisir</option>
                <option value="Technologie">Technologie</option>
                <option value="Sant√©">Sant√©</option>
                <option value="Lifestyle">Lifestyle</option>
                <option value="Cuisine">Cuisine</option>
                <option value="Animaux">Animaux</option>
                <option value="Nature">Nature</option>
                <option value="R√©seaux sociaux">R√©seaux sociaux</option>
                <option value="Autres">Autres</option>
                <option value="Badges cach√©s">Badges cach√©s</option>
              </select>

              <!-- Options Low skill et Fant√¥me (toujours visibles, sous le th√®me) -->
              <div class="toggle-row" style="margin-top: 12px;">
                <button type="button" id="badge-low-skill-toggle" class="ghost toggle-btn">Low skill : d√©sactiv√©</button>
                <input id="badge-low-skill" type="hidden" value="0">
              </div>

              <div class="toggle-row">
                <button type="button" id="badge-ghost-toggle" class="ghost toggle-btn">Badge fant√¥me : d√©sactiv√©</button>
                <input id="badge-ghost" type="hidden" value="0">
              </div>
            </div>

            <!-- Bloc badge fant√¥me -->
            <div id="block-ghost" class="answer-block hidden">
              <label class="form-label">Badges requis</label>
              <select id="ghost-required-badges-select" class="select-multi" multiple size="8"></select>
              <small class="muted">Tu peux s√©lectionner plusieurs badges.</small>
              
              <label class="form-label form-label-spaced">Pr√©-requis</label>
              <div class="prereq-item" style="margin-bottom: 12px;">
                <label for="ghost-prereq-mode" class="muted">Mode de pr√©requis</label>
                <select id="ghost-prereq-mode">
                  <option value="all">ET (tous les pr√©requis doivent √™tre vrais)</option>
                  <option value="any">OU (au moins un pr√©requis doit √™tre vrai)</option>
                </select>
              </div>
              <div class="prereq-grid">
                <div class="prereq-item">
                  <label for="ghost-min-badges" class="muted">Badges d√©bloqu√©s (min)</label>
                  <input id="ghost-min-badges" type="number" min="0" step="1" placeholder="Ex: 2">
                </div>
                <div class="prereq-item">
                  <label for="ghost-min-skills" class="muted">Points de skills (min)</label>
                  <input id="ghost-min-skills" type="number" min="0" step="1" placeholder="Ex: 3">
                </div>
                <div class="prereq-item">
                  <label for="ghost-min-rank" class="muted">Rang minimum</label>
                  <select id="ghost-min-rank">
                    <option value="">Aucun</option>
                    <option value="Minimaliste">Minimaliste</option>
                    <option value="Simple">Simple</option>
                    <option value="Normale">Normale</option>
                    <option value="Ais√©e">Ais√©e</option>
                    <option value="Incroyable">Incroyable</option>
                    <option value="R√™ve">R√™ve</option>
                  </select>
                </div>
              </div>
              <label for="ghost-display-text" class="form-label form-label-spaced">Remplace la r√©ponse</label>
              <textarea id="ghost-display-text" rows="2" placeholder="Ex: D√©bloqu√© automatiquement"></textarea>
              <label for="ghost-skill-points" class="form-label form-label-spaced">Points skills</label>
              <input id="ghost-skill-points" type="number" min="0" step="1" placeholder="Laisse vide pour 1 point par d√©faut">
              <small class="muted">Si vide, le badge vaut 1 point lorsqu'il est d√©bloqu√©.</small>
            </div>

            <!-- Type de r√©ponse (cach√© si fant√¥me) -->
            <div class="form-group non-ghost-only">
              <label for="answer-type" class="form-label">Type de r√©ponse</label>
              <select id="answer-type">
                <option value="text">Texte exact (r√©ponse simple)</option>
                <option value="boolean">Oui / Non</option>
                <option value="range">Num√©rotation</option>
                <option value="singleSelect">S√©lection unique</option>
                <option value="multiSelect">Multi-s√©lection</option>
              </select>
            </div>

            <!-- Bloc r√©ponse texte -->
            <div id="block-text" class="answer-block non-ghost-only">
              <label for="answer-text" class="form-label">R√©ponse attendue (texte)</label>
              <input id="answer-text" type="text" placeholder="Ex: javascript">
            </div>

            <!-- Bloc r√©ponse boolean -->
            <div id="block-boolean" class="answer-block hidden non-ghost-only">
              <label for="bool-display-text" class="form-label">Remplace la r√©ponse (si "oui")</label>
              <textarea id="bool-display-text" rows="2" placeholder="Ex: A r√©pondu √† la question"></textarea>
              
              <label for="bool-display-text-false" class="form-label form-label-spaced">Remplace la r√©ponse (si "non")</label>
              <textarea id="bool-display-text-false" rows="2" placeholder="Ex: N'a pas r√©pondu √† la question"></textarea>
              
              <label for="bool-skill-points" class="form-label form-label-spaced">Points skills (si "oui")</label>
              <input id="bool-skill-points" type="number" min="0" step="1" placeholder="Laisse vide pour 1 point par d√©faut">
              <small class="muted">Si vide, le badge vaut 1 point.</small>
            </div>

            <!-- Bloc r√©ponse range -->
            <div id="block-range" class="answer-block hidden non-ghost-only">
              <label class="form-label">Niveaux (un par ligne)</label>
              <textarea id="range-levels" rows="4" placeholder="Ex:&#10;Skill 1|0|4|3&#10;Skill 2|5|9|5&#10;Skill myst√®re|10|999|10"></textarea>
              <small class="muted">Format : label|min|max|points. Points optionnel (d√©faut: position dans la liste). Utilise "Skill myst√®re" si tu veux un skill myst√®re.</small>
            </div>

            <!-- Bloc multi-s√©lection -->
            <div id="block-multi" class="answer-block hidden non-ghost-only">
              <label class="form-label">Les choix de r√©ponses</label>
              <textarea id="multi-options" rows="4" placeholder="valeur|Libell√©"></textarea>
              
              <label class="form-label form-label-spaced">Niveaux (un par ligne)</label>
              <textarea id="multi-levels" rows="3" placeholder="Ex:&#10;Skill 1|1|3&#10;Skill 2|3|5&#10;Skill myst√®re|5|10"></textarea>
              <small class="muted">Format : label|min s√©lection|points. Ex: "Skill 1|1|3" = Skill 1 n√©cessite 1 s√©lection et donne 3 points. Le champ "points" est optionnel (d√©faut: position dans la liste). Utilise "Skill myst√®re" si besoin.</small>
              
              <div class="toggle-row" style="margin-top: 12px;">
                <button type="button" id="multi-skill-by-option-toggle" class="ghost toggle-btn">Skills par option : d√©sactiv√©</button>
                <input id="multi-skill-by-option" type="hidden" value="0">
              </div>
              <div id="multi-skill-by-option-block" class="hidden">
                <label class="form-label form-label-spaced">Skills par option (une par ligne)</label>
                <textarea id="multi-option-skills" rows="4" placeholder="valeur|Skill 1|3&#10;valeur2|Expert|10&#10;valeur3|bloquer"></textarea>
                <small class="muted">Format : valeur|skill|points. Ex: "valeur1|Skill 1|3" = cette option donne Skill 1 avec 3 points.</small>
                <small class="muted">‚Ä¢ Skill = d√©bloque avec ce niveau et ces points</small>
                <small class="muted">‚Ä¢ Expert = niveau myst√®re</small>
                <small class="muted">‚Ä¢ bloquer = badge non d√©bloqu√© (retourne dans la roue)</small>
              </div>
              
              <div class="toggle-row" style="margin-top: 12px;">
                <button type="button" id="multi-display-list-toggle" class="ghost toggle-btn">Liste : d√©sactiv√©e</button>
                <input id="multi-display-list" type="hidden" value="0">
              </div>
              <small class="muted">Si "Liste" est activ√©e : on affichera les choix coch√©s. Sinon : on affichera le nombre de coches.</small>
            </div>

            <!-- Bloc s√©lection unique -->
            <div id="block-single" class="answer-block hidden non-ghost-only">
              <label class="form-label">Choix de r√©ponses</label>
              <textarea id="single-options" rows="4" placeholder="valeur|Libell√©"></textarea>
              
              <label class="form-label form-label-spaced">Skills par option</label>
              <textarea id="single-skills" rows="3" placeholder="valeur|Skill 1&#10;valeur2|Expert&#10;valeur3|bloquer"></textarea>
              <small class="muted">Options : Skill 1, Skill 2, Expert, ou bloquer.</small>
              <small class="muted">‚Ä¢ Skill = d√©bloque le badge avec ce niveau</small>
              <small class="muted">‚Ä¢ Expert = niveau myst√®re (cach√©)</small>
              <small class="muted">‚Ä¢ bloquer = badge non d√©bloqu√© (retourne dans la roue)</small>
            </div>

            <!-- Options d'affichage -->
            <div class="form-group non-ghost-only non-boolean-only">
              <label for="display-prefix" class="form-label">Texte avant (optionnel)</label>
              <input id="display-prefix" type="text" placeholder="Ex: J'ai :">

              <label for="display-suffix" class="form-label form-label-spaced">Texte apr√®s (optionnel)</label>
              <input id="display-suffix" type="text" placeholder="Ex: pays visit√©s">
            </div>

            <!-- Message si non d√©bloqu√© -->
            <div class="form-group non-ghost-only">
              <label for="blocked-message" class="form-label">Message si non d√©bloqu√© (optionnel)</label>
              <textarea id="blocked-message" rows="2" placeholder="Ex: Tu n'as pas assez voyag√© pour d√©bloquer ce badge !"></textarea>
              <small class="muted">Ce message s'affiche dans la roue si le badge n'est pas d√©bloqu√©. Laisse vide pour le message par d√©faut.</small>
            </div>

            <!-- Boutons d'action -->
            <div class="action-buttons">
              <button type="submit" class="primary">Enregistrer</button>
              <button type="button" id="btn-delete" class="ghost">Supprimer</button>
              <button type="button" id="btn-reset" class="ghost">R√©initialiser</button>
            </div>
            <p id="form-message" class="message"></p>
          </form>
        </div>
      </div>
    </section>
  </div>
</body>
</html>
