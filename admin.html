<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BadgeLife ‚Ä¢ Admin badges</title>
  <link rel="stylesheet" href="./styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script type="module" src="./admin.js" defer></script>
</head>
<body>
  <div class="page">
    <header class="topbar">
      <div class="brand">
        <img src="./icons/logobl.png" alt="BadgeLife" class="logo small">
        <div>
          <p class="muted">Admin</p>
          <strong>Gestion des badges</strong>
        </div>
      </div>
      <div>
        <a class="ghost" href="./index.html">‚Üê Retour app</a>
      </div>
    </header>

    <section class="card" id="admin-auth-card">
      <h2>Connexion admin</h2>
      <p class="muted">Entre ton pseudo et ton mot de passe admin.</p>
      <form id="admin-login-form" class="auth-form">
        <label for="admin-username">Pseudo</label>
        <input id="admin-username" type="text" required placeholder="Ex: AdminMaster">
        <label for="admin-password">Mot de passe</label>
        <input id="admin-password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        <button type="submit" class="primary">Se connecter</button>
      </form>
      <p id="admin-message" class="message"></p>
    </section>

    <section id="admin-app" class="card hidden">
      <div class="row" style="justify-content: space-between; align-items: center;">
        <h2>Badges</h2>
        <button id="admin-logout" class="ghost">Se d√©connecter</button>
      </div>
      <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
        <div>
          <div class="row" style="justify-content: space-between; align-items: baseline;">
            <h3>Liste</h3>
            <small id="admin-badge-total" class="muted">Total : 0</small>
          </div>
          <div class="table">
            <div class="table-head" style="display:grid; grid-template-columns: 0.35fr minmax(180px, 1fr) 1fr; gap:8px;">
              <span>Emoji</span><span>Nom</span><span>Statut skills</span>
            </div>
            <div id="badge-list" class="table-body"></div>
          </div>
        </div>
        <div>
          <h3>√âdition / cr√©ation</h3>
          <form id="badge-form" class="auth-form">
            <label for="badge-id">ID (optionnel si auto-incr.)</label>
            <input id="badge-id" type="text" placeholder="Laisse vide pour nouvel ID">

            <label for="badge-name">Nom</label>
            <input id="badge-name" type="text" required>

            <label for="badge-emoji">Emoji</label>
            <input id="badge-emoji" type="text" placeholder="Ex: üöÄ">

            <div class="row" style="gap:10px; align-items:center;">
              <button type="button" id="badge-low-skill-toggle" class="ghost">Low skill : d√©sactiv√©</button>
              <input id="badge-low-skill" type="hidden" value="0">
            </div>

            <div class="row" style="gap:10px; align-items:center;">
              <button type="button" id="badge-ghost-toggle" class="ghost">Badge fant√¥me : d√©sactiv√©</button>
              <input id="badge-ghost" type="hidden" value="0">
            </div>

            <label for="badge-description">Description</label>
            <textarea id="badge-description" rows="2"></textarea>

            <label for="badge-theme">Th√®me (optionnel)</label>
            <input id="badge-theme" type="text" list="theme-options" placeholder="Choisis un th√®me...">
            <datalist id="theme-options">
              <option value="Sport"></option>
              <option value="Voyage"></option>
              <option value="Relations"></option>
              <option value="Amour"></option>
              <option value="√âtudes"></option>
              <option value="Travail"></option>
              <option value="Loisir"></option>
              <option value="Technologie"></option>
              <option value="Sant√©"></option>
              <option value="Lifestyle"></option>
              <option value="Cuisine"></option>
              <option value="Animaux"></option>
              <option value="Nature"></option>
              <option value="R√©seaux sociaux"></option>
              <option value="Autres"></option>
              <option value="Badges cach√©s"></option>
            </datalist>

            <div id="block-ghost" class="answer-block hidden">
              <label>Badges requis</label>
              <select id="ghost-required-badges-select" class="select-multi" multiple size="8"></select>
              <small class="muted">Tu peux s√©lectionner plusieurs badges (Ctrl/Cmd + clic).</small>
              
              <label style="margin-top:10px;">Pr√©-requis</label>
              <div style="margin: 6px 0 10px;">
                <label for="ghost-prereq-mode" class="muted" style="display:block; margin-bottom:4px;">Mode de pr√©requis</label>
                <select id="ghost-prereq-mode">
                  <option value="all">ET (tous les pr√©requis doivent √™tre vrais)</option>
                  <option value="any">OU (au moins un pr√©requis doit √™tre vrai)</option>
                </select>
              </div>
              <div class="row" style="gap:10px; flex-wrap:wrap;">
                <div style="min-width:160px; flex: 1 1 160px;">
                  <label for="ghost-min-badges" class="muted" style="display:block; margin-bottom:4px;">Badges d√©bloqu√©s (min)</label>
                  <input id="ghost-min-badges" type="number" min="0" step="1" placeholder="Ex: 2">
                </div>
                <div style="min-width:160px; flex: 1 1 160px;">
                  <label for="ghost-min-skills" class="muted" style="display:block; margin-bottom:4px;">Points de skills (min)</label>
                  <input id="ghost-min-skills" type="number" min="0" step="1" placeholder="Ex: 3">
                </div>
                <div style="min-width:160px; flex: 1 1 160px;">
                  <label for="ghost-min-rank" class="muted" style="display:block; margin-bottom:4px;">Rang minimum</label>
                  <select id="ghost-min-rank">
                    <option value="">Aucun</option>
                    <option value="D√©butant">D√©butant</option>
                    <option value="Apprenti">Polyvalent</option>
                    <option value="Confirm√©">Comp√©tent</option>
                    <option value="Sp√©cialiste">Accompli</option>
                    <option value="L√©gende">Multiskills</option>
                  </select>
                </div>
              </div>
              <label for="ghost-display-text" style="margin-top:10px;">Remplace la r√©ponse</label>
              <textarea id="ghost-display-text" rows="2" placeholder="Ex: D√©bloqu√© automatiquement"></textarea>
              <small class="muted">Ce badge sera d√©bloqu√© automatiquement quand tous les badges requis sont d√©bloqu√©s. Il n'appara√Ætra pas dans "Tous les badges".</small>
            </div>

            <label for="badge-question" class="non-ghost-only">Question</label>
            <textarea id="badge-question" class="non-ghost-only" rows="2"></textarea>

            <label for="answer-type" class="non-ghost-only">Type de r√©ponse</label>
            <select id="answer-type" class="non-ghost-only">
              <option value="text">Texte exact (r√©ponse simple)</option>
              <option value="boolean">Oui / Non</option>
              <option value="range">Num√©rotation</option>
              <option value="singleSelect">S√©lection unique</option>
              <option value="multiSelect">Multi-s√©lection</option>
            </select>

            <div id="block-text" class="answer-block non-ghost-only">
              <label for="answer-text">R√©ponse attendue (texte)</label>
              <input id="answer-text" type="text" placeholder="Ex: javascript">
            </div>

            <div id="block-boolean" class="answer-block hidden non-ghost-only">
              <label for="bool-display-text">Remplace la r√©ponse</label>
              <textarea id="bool-display-text" rows="2" placeholder="Ex: A r√©pondu √† la question"></textarea>
              <small class="muted">Ce texte sera affich√© dans ‚ÄúMes badges‚Äù √† la place de ‚Äúoui/non‚Äù.</small>
            </div>

            <div id="block-range" class="answer-block hidden non-ghost-only">
              <label>Niveaux (un par ligne)</label>
              <textarea id="range-levels" rows="4" placeholder="Ex:&#10;Skill 1|0|4&#10;Skill 2|5|9&#10;Skill myst√®re|10|999"></textarea>
              <small class="muted">Format : label|min|max. Utilise ‚ÄúSkill myst√®re‚Äù si tu veux un skill myst√®re.</small>
            </div>

            <div id="block-multi" class="answer-block hidden non-ghost-only">
              <label>Les choix de r√©ponses</label>
              <textarea id="multi-options" rows="4" placeholder="valeur|Libell√©"></textarea>
              <label>Niveaux (un par ligne)</label>
              <textarea id="multi-levels" rows="3" placeholder="Ex:&#10;Skill 1|1&#10;Skill myst√®re|3"></textarea>
              <small class="muted">Format skills : label|min s√©lection. Utilise ‚ÄúSkills myst√®re‚Äù si besoin.</small>
              <div class="row" style="gap:10px; align-items:center; margin-top:10px;">
                <button type="button" id="multi-skill-by-option-toggle" class="ghost">Skills par option : d√©sactiv√©</button>
                <input id="multi-skill-by-option" type="hidden" value="0">
              </div>
              <div id="multi-skill-by-option-block" class="hidden" style="margin-top:10px;">
                <label>Skills par option (une par ligne)</label>
                <textarea id="multi-option-skills" rows="4" placeholder="valeur|Skill 1&#10;valeur2|Expert&#10;valeur3|aucun"></textarea>
                <small class="muted">Quand activ√© : le niveau d√©pend des options coch√©es (pas du nombre). Mets vide apr√®s le | pour ‚Äúaucun skill‚Äù.</small>
              </div>
              <div class="row" style="gap:10px; align-items:center; margin-top:10px;">
                <button type="button" id="multi-display-list-toggle" class="ghost">Liste : d√©sactiv√©e</button>
                <input id="multi-display-list" type="hidden" value="0">
              </div>
              <small class="muted">Si ‚ÄúListe‚Äù est activ√©e : on affichera les choix coch√©s. Sinon : on affichera le nombre de coches.</small>
            </div>

            <div id="block-single" class="answer-block hidden non-ghost-only">
              <label>Choix de r√©ponses</label>
              <textarea id="single-options" rows="4" placeholder="valeur|Libell√©"></textarea>
              <label style="margin-top:10px;">Skills par option (une par ligne)</label>
              <textarea id="single-skills" rows="3" placeholder="valeur|Skill 1&#10;valeur2|aucun&#10;valeur3|Skill myst√®re"></textarea>
              <small class="muted">Chaque option peut donner un skill. (laisse vide apr√®s le |) si cette option ne doit donner aucun skill.</small>
              <small class="muted">L‚Äôutilisateur pourra choisir une seule option.</small>
            </div>

            <label for="display-prefix" class="non-ghost-only non-boolean-only">Texte avant (optionnel)</label>
            <input id="display-prefix" class="non-ghost-only non-boolean-only" type="text" placeholder="Ex: J'ai :">

            <label for="display-suffix" class="non-ghost-only non-boolean-only">Texte apr√®s (optionnel)</label>
            <input id="display-suffix" class="non-ghost-only non-boolean-only" type="text" placeholder="Ex: pays visit√©s">

            <div class="row" style="gap:10px; flex-wrap: wrap;">
              <button type="submit" class="primary">Enregistrer</button>
              <button type="button" id="btn-delete" class="ghost">Supprimer</button>
              <button type="button" id="btn-reset" class="ghost">R√©initialiser</button>
            </div>
            <p id="form-message" class="message"></p>
          </form>
        </div>
      </div>
    </section>
  </div>
</body>
</html>

